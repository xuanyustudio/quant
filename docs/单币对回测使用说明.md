# 单币对回测功能使用说明

## 功能概述

单币对回测功能允许您快速回测指定的两个币种在特定时间段的表现，无需重新分析相关性，大大提高了测试效率。

## 快速使用

### 基本命令格式

```bash
node src/statistical-arbitrage/backtest-single-pair.js --symbol1=币种1 --symbol2=币种2 --start=开始日期 --end=结束日期
```

### 示例

回测 ADA/DOT 在2025年9月的表现：

```bash
node src/statistical-arbitrage/backtest-single-pair.js --symbol1=ADA/USDT --symbol2=DOT/USDT --start=2025-09-01 --end=2025-09-30
```

## 参数说明

| 参数 | 说明 | 必填 | 示例 |
|------|------|------|------|
| `--symbol1` | 第一个交易对 | 是 | `ADA/USDT` |
| `--symbol2` | 第二个交易对 | 是 | `DOT/USDT` |
| `--start` | 开始日期 (YYYY-MM-DD) | 是 | `2025-09-01` |
| `--end` | 结束日期 (YYYY-MM-DD) | 是 | `2025-09-30` |

## 功能特点

✅ **无需相关性分析** - 直接指定币对进行回测  
✅ **灵活的时间范围** - 可以回测任意历史时间段  
✅ **详细的报告** - 生成完整的HTML可视化报告  
✅ **快速执行** - 跳过配对筛选，大幅提升速度  

## 使用场景

1. **深度分析特定币对**：在发现某个表现良好的币对后，可以用这个工具快速测试它在不同月份的表现
2. **历史验证**：验证某个策略参数在历史不同时间段的稳定性
3. **快速迭代**：在调整策略参数后，快速验证单个币对的表现

## 输出结果

回测完成后会输出：
- 📊 收益率
- 🎯 胜率  
- 📈 夏普比率
- 📉 最大回撤
- 🔄 交易次数
- 📊 相关系数
- 📄 HTML详细报告（包含价格走势图和交易记录表）

## 常见问题

### Q: 可以使用哪些交易对？
A: 支持配置文件中 `config.js` 里定义的所有交易对。

### Q: 历史数据的时间范围有限制吗？
A: 取决于交易所提供的历史数据。币安一般支持较长的历史数据查询。

### Q: 回测使用什么级别的K线？
A: 由配置文件中的 `backtestTimeframe` 参数决定，默认为15分钟K线。

##配置说明

在 `src/statistical-arbitrage/config.js` 中可以调整：
- `backtestTimeframe`: 回测使用的K线周期（默认15m）
- `entryThreshold`: 开仓Z-score阈值
- `exitThreshold`: 平仓Z-score阈值  
- `stopLossThreshold`: 止损Z-score阈值
- `positionSize`: 仓位比例
- `initialCapital`: 初始资金
- `commission`: 手续费率

## 注意事项

⚠️ **代理配置**：如果使用币安交易所，请确保本地代理（`localhost:7897`）正在运行  
⚠️ **数据限制**：某些交易所对历史数据查询有限制，过长的时间范围可能无法获取完整数据  
⚠️ **回测局限性**：回测结果仅供参考，不代表未来表现  

## 与标准回测的区别

| 特性 | 标准回测 | 单币对回测 |
|------|---------|-----------|
| 相关性分析 | ✅ 自动筛选 | ❌ 跳过 |
| 币对数量 | 多个 (top 5) | 单个 |
| 执行速度 | 较慢 | 快速 |
| 使用场景 | 发现新机会 | 验证特定币对 |
| 命令 | `npm run stat-arb:backtest` | `node src/statistical-arbitrage/backtest-single-pair.js` |

